---
title: "Telco Project"
author: "Rami"
date: "May 20, 2016"
output: html_document
---

# Setup

```{r}
# options( java.parameters = "-Xmx12g" )
# library(MASS)
library(dplyr)
library(knitr)
# library(reshape2)
library(caret)
# library(FactoMineR)
# library(corrplot)
# library(e1071)
# library(randomForest)
# Let's not thrash my SSD to death for the sake of this project..
# library(doMC)
# registerDoMC(cores = 3)
```

```{r}
train <- read.csv("engineered.train.csv")
test <- read.csv("engineered.test.csv")
train$TARGET <- factor(train$TARGET)
levels(train$TARGET) <- c("Negative", "Positive")
```

# PLS

```{r}
set.seed(1337)
#tmp <- select(train, -c(TARGET, CONTRACT_KEY, HANDSET_NAME, RATE_PLAN, GENDER, VALUE_SEGMENT)) %>% as.matrix
model.pls <- plsda(TARGET ~ .,
                   train,
                   scale = TRUE,
                   probMehod = "softmax",
                   ncomp = 5)
```

```{r}
set.seed(1337)
model.pls <- train(TARGET ~ .,
                   train %>% select(-CONTRACT_KEY),
                   method = "pls",
                   tuneGrid = expand.grid(.ncomp = 20:20),
                   #scale = TRUE,
                   probMehod = "softmax",
                   #ncomp = 5,
                   metric = "ROC",
                   na.action = na.pass,
                   trControl = trainControl(
                     number = 1,
                     classProbs = TRUE,
                     savePredictions = TRUE,
                     summaryFunction = twoClassSummary),
                   verbose = TRUE)
```

```{r}
pred.pls <- predict(model.pls,
        newdata = select(test, -CONTRACT_KEY),
        type = "prob",
        na.action = na.pass)
```

```{r}
pred.pls <- predict(model.rpart, newdata = test)
```


# RPART

```{r}
model.rpart <- train(x = select(train, -c(TARGET, CONTRACT_KEY)),
                     y = select(train, TARGET),
                     method = "rpart",
                     tuneLength = 10,
                     preProcess = c("knnImpute"),
                     trControl = trainControl(
                       method = "cv",
                       number = 15,
                       classProbs = TRUE,
                       savePredictions = TRUE,
                       summaryFunction = twoClassSummary),
                     metric = "ROC")
```

```{r}
pred.rpart <- predict(model.rpart, newdata = test)
```

# Partial Least Squares

# Neural Network

# Discriminant Analysis

```{r}
model.qda <- qda(TARGET ~ ., data = train)
```

# Random Forest

Do MCA..
